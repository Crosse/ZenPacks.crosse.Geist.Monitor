name: ZenPacks.crosse.Geist.Monitor

classes:
    GeistMonitorDevice:
        base: [zenpacklib.Device]
        label: Geist Monitor
        properties:
            sensor_count:
                label: Sensor Count
                type: int

    GeistClimateSensor:
        base: [zenpacklib.Component]
        label: Climate Sensor
        properties:
            DEFAULTS:
                type: int

            climateSerial:
                label: Serial Number
                type: string
                content_width: 110
                order: 1
            climateAvail:
                label: Connected
                type: boolean
                renderer: Zenoss.render.checkbox
                order: 2
                datapoint: climateAvail_climateAvail
            climateTempC:
                label: Temperature
                short_label: Temp
                order: 3
                datapoint: climateTempC_climateTempC
            climateIO1:
                label: IO Port 1
                short_label: IO1
                order: 4
                datapoint: climateIO1_climateIO1
            climateIO2:
                label: IO Port 2
                short_label: IO2
                order: 4
                datapoint: climateIO2_climateIO2
            climateIO3:
                label: IO Port 3
                short_label: IO3
                order: 4
                datapoint: climateIO3_climateIO3

    GeistTemperatureSensor:
        base: [zenpacklib.Component]
        label: Temperature Sensor
        properties:
            DEFAULTS:
                type: int

            tempSensorSerial:
                label: Serial Number
                type: string
                content_width: 110
                order: 1
            tempSensorAvail:
                label: Connected
                type: boolean
                renderer: Zenoss.render.checkbox
                order: 2
                datapoint: tempSensorAvail_tempSensorAvail
            tempSensorTempC:
                label: Temperature
                short_label: Temp
                order: 3
                datapoint: tempSensorTempC_tempSensorTempC


class_relationships:
    - GeistMonitorDevice(geistClimateSensors) 1:MC (geistMonitorDevice)GeistClimateSensor
    - GeistMonitorDevice(geistTemperatureSensors) 1:MC (geistMonitorDevice)GeistTemperatureSensor

device_classes:
    /Environment/Geist:
        zProperties:
            zPythonClass: ZenPacks.crosse.Geist.Monitor.GeistMonitorDevice
            zSnmpMonitorIgnore: false
            zSnmpVer: 1
            zCollectorPlugins:
                - crosse.snmp.Geist.Monitor
                - zenoss.snmp.NewDeviceMap
                - zenoss.snmp.DeviceMap
                - zenoss.snmp.InterfaceMap

        templates:
            ClimateSensor:
                targetPythonClass: ZenPacks.crosse.Geist.Monitor.GeistClimateSensor
                description: Climate sensors (internal sensors for RacSense units)

                datasources:
                    climateAvail:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.4
                        component: "${here/id}"
                        datapoints:
                            climateAvail:
                                rrdtype: GAUGE
                                description: Is device currently plugged in?
                    climateTempC:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.5
                        component: "${here/id}"
                        datapoints:
                            climateTempC:
                                rrdtype: GAUGE
                                description: Current reading for Temperature (C)
                    climateHumidity:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.6
                        component: "${here/id}"
                        datapoints:
                            climateHumidity:
                                rrdtype: GAUGE
                                description: Current reading for Humidity
                    climateAirflow:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.7
                        component: "${here/id}"
                        datapoints:
                            climateAirflow:
                                rrdtype: GAUGE
                                description: Current reading for Airflow
                    climateLight:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.8
                        component: "${here/id}"
                        datapoints:
                            climateLight:
                                rrdtype: GAUGE
                                description: Current reading for Ambient Light
                    climateSound:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.9
                        component: "${here/id}"
                        datapoints:
                            climateSound:
                                rrdtype: GAUGE
                                description: Current reading for Sound
                    climateIO1:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.10
                        component: "${here/id}"
                        datapoints:
                            climateIO1:
                                rrdtype: GAUGE
                                description: Current reading for Analog Input 1
                    climateIO2:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.11
                        component: "${here/id}"
                        datapoints:
                            climateIO2:
                                rrdtype: GAUGE
                                description: Current reading for Analog Input 2
                    climateIO3:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.2.1.12
                        component: "${here/id}"
                        datapoints:
                            climateIO3:
                                rrdtype: GAUGE
                                description: Current reading for Analog Input 3

                graphs:
                    Temperature:
                        units: degrees Celsius
                        height: 100
                        width: 500
                        graphpoints:
                            Temperature:
                                dpName: climateTempC_climateTempC
                                format: "%6.2lf°C"

                    IO Ports:
                        height: 100
                        width: 500
                        graphpoints:
                            IO1:
                                dpName: climateIO1_climateIO1
                                format: "%6.2lf"
                            IO2:
                                dpName: climateIO2_climateIO2
                                format: "%6.2lf"
                            IO3:
                                dpName: climateIO3_climateIO3
                                format: "%6.2lf"

            TemperatureSensor:
                targetPythonClass: ZenPacks.crosse.Geist.Monitor.GeistTemperatureSensor
                description: Temperature Sensors

                datasources:
                    tempSensorAvail:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.4.1.4
                        component: "${here/id}"
                        datapoints:
                            tempSensorAvail:
                                rrdtype: GAUGE
                                description: Is device currently plugged in?
                    tempSensorTempC:
                        type: SNMP
                        oid: 1.3.6.1.4.1.21239.1.4.1.5
                        datapoints:
                            tempSensorTempC:
                                rrdtype: GAUGE
                                description: Temperature in Celsius

                graphs:
                    Temperature:
                        units: degrees Celsius
                        height: 100
                        width: 500
                        graphpoints:
                            Temperature:
                                dpName: tempSensorTempC_tempSensorTempC
                                format: "%6.2lf°C"

